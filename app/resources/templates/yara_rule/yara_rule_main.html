{% extends "index.html" %}
{% block title %}
    Yara rule管理
{% endblock %}
{% block content %}
<div class="content-page">
    <div class="maliciousfile-fluid">

        <div class="row">
            <div class="col">
                <div class="page-title-box">
                    <h4 class="page-title">Yara rule管理</h4>
                </div>
            </div>
        </div>

        <div class="row" v-cloak id="vue-app-yararule-id">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <div class="row mb-2">
                            <div class="col-md-6">
                                <a title="新增情資" class="btn btn-primary" href="/yara_rule/update/">
                                    <span class="material-icons">add</span>
                                    <span>新增Yara rule</span>
                                </a>
                            </div>

                            <div class="col-md-6 d-flex justify-content-end align-items-center">
                                <select id="pid" class="form-select me-3 w-25" @change="getDataOnSearch()"
                                    v-model="yaraPaging.searchFilter.category">
                                    <option value="">全部</option>
                                    <option v-for="item in tagList" :value="item">
                                        [[item]]
                                    </option>
                                </select>
                                <div class="input-group w-50">
                                    <input type="text" placeholder="輸入名稱搜尋" class="form-control" v-model="yaraPaging.searchFilter.search_text">
                                    <div class="input-group-append" v-on:click="getDataOnSearch()">
                                        <span class="input-group-text" href="#">
                                            <span class="material-icons">search</span>
                                        </span>
                                    </div>
                                </div>
                                <a data-bs-toggle="collapse" href="#advanceSearchYara" role="button"
                                    aria-expanded="false" aria-controls="advanceSearchYara" title="進階搜尋"
                                    class="btn btn-secondary"><span
                                        class="material-icons">manage_search</span></a>
                            </div>
                        </div>
                        <div class="row mb-2 collapse" id="advanceSearchYara">
                            <hr class="my-4">
                            </hr>
                            <div class="col-md-6">
                                <div class="form-group"><label for="search-date-start">起始日</label> <input
                                        type="date" id="search-date-start" class="form-control"></div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group"><label for="search-date-stop">結束日</label> <input
                                        type="date" id="search-date-stop" class="form-control"></div>
                            </div>
                            <div class="col-md-12 d-flex justify-content-end mt-2">
                                <button class="btn btn-primary me-2">清除</button>
                                <button class="btn btn-primary">查詢</button>
                            </div>
                            <hr class="my-4">
                            </hr>
                        </div>

                        <table class="table table-responsive table-hover">

                            <thead class="table-light">
                                <tr>
                                    <th scope="col">名稱</th>
                                    <th scope="col">標籤</th>
                                    <th scope="col">創建時間</th>
                                    <th scope="col">作者</th>
                                    <th scope="col">動作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="yara in yaraPaging.paging.items">
                                    <td>[[yara.name]]</td>
                                    <td>[[yara.tag?.tag]]</td>
                                    <td>[[yara.created_date]]</td>
                                    <td> [[yara.author?.name]] </td>
                                    <td>
                                        <a title="預覽" class="m-3" v-on:click="editYararuleList(yara.id)"
                                            data-bs-toggle="modal" data-bs-target="#editModal"><span
                                                class="material-icons-outlined action">visibility</span></a>
                                        <a title="編輯" class="m-3" href="/yara_rule/update/"><span
                                                class="material-icons-outlined action">edit</span></a>
                                        <a title="刪除" class="m-3" v-on:click="onDeleteRule(yara.id, yara.name)"><span
                                                class="material-icons-outlined action">delete</span></a>
                                    </td>
                                </tr>
                            </tbody>

                        </table>
                        <nav aria-label="Page navigation example">
                            <ul class="pagination justify-content-center">
                                <li class="page-item">
                                    <a class="page-link" href="#" aria-label="Previous" v-on:click="updatePage(-1)"
                                        v-bind:class="{'disabled':yaraPaging.paging.current_page === 1}">
                                        <span aria-hidden="true">&laquo;</span>
                                    </a>
                                </li>
                                <li v-for="pageNumber in yaraPaging.paging.total_page" class="page-item"
                                    v-on:click="searchPage(pageNumber)"
                                    v-bind:class="{'active': yaraPaging.paging.current_page === pageNumber}">
                                    <a class="page-link" href="#" v-if="isDisplayPaging(pageNumber)">[[pageNumber]]</a>
                                </li>
                                <li class="page-item">
                                    <a class="page-link" href="#" aria-label="Next" v-on:click="updatePage(1)"
                                        v-bind:class="{'disabled':yaraPaging.paging.current_page === yaraPaging.paging.total_page}">
                                        <span aria-hidden="true">&raquo;</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- Modal -->
            <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editYararuleList"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="editYararuleList">內容</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="form-floating mb-3">
                                <input type="text" class="form-control" id="inputName" placeholder="name"
                                    v-model="selectInputYararuleList.rule" style="height: 150px;">
                                <label for="inputName">[[selectInputYararuleList.rule]]</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- footer -->
<div class="content-page collapse">
    <div class="page-footer font-small collapse">
        <script src="/statics/js/footer.js"></script>

        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <p class="pt-3 position-absolute" id="version-number">版號</p>
                    <!-- Copyright -->
                    <div class="footer-copyright text-end pt-3">
                        <p id="p-footer-copyright"></p>
                    </div>
                    <!-- Copyright -->
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}

{% block script %}
<script src="/statics/js/yara_rule_main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
{% endblock %}


